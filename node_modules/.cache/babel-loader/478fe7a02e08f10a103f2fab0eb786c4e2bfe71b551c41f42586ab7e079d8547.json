{"ast":null,"code":"import React,{useRef,useState,useEffect}from\"react\";import Webcam from\"react-webcam\";import jsQR from\"jsqr\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function StudentHome(){const webcamRef=useRef(null);const[scanResults,setScanResults]=useState([]);const[error,setError]=useState(\"\");useEffect(()=>{checkPermissions();const interval=setInterval(()=>{capture();},1000);// continuously capture every 1000 milliseconds (1 second)\nreturn()=>{clearInterval(interval);// clear the interval when the component unmounts\nstopWebcam();};},[]);// check for camera access permissions and handle errors\nconst checkPermissions=async()=>{try{await navigator.mediaDevices.getUserMedia({video:true});// permissions granted\nsetError(\"\");}catch(err){console.error(\"Error accessing the camera: \",err);setError(\"Camera access was denied. Please allow camera permissions in your browser settings.\");}};const stopWebcam=()=>{if(webcamRef.current&&webcamRef.current.video.srcObject){const tracks=webcamRef.current.video.srcObject.getTracks();tracks.forEach(track=>track.stop());}};const capture=()=>{const imageSrc=webcamRef.current.getScreenshot();if(imageSrc){decodeQRFromImage(imageSrc);}};const decodeQRFromImage=imageSrc=>{const canvas=document.createElement(\"canvas\");const ctx=canvas.getContext(\"2d\");const image=new Image();image.src=imageSrc;image.onload=()=>{canvas.width=image.width;canvas.height=image.height;ctx.drawImage(image,0,0,canvas.width,canvas.height);const imageData=ctx.getImageData(0,0,canvas.width,canvas.height);const code=jsQR(imageData.data,imageData.width,imageData.height,{inversionAttempts:\"dontInvert\"});if(code){setScanResults(prevResults=>[...prevResults,\"QR Code Detected: \".concat(code.data)]);}};};return/*#__PURE__*/_jsxs(\"div\",{style:{position:\"relative\"},children:[error?/*#__PURE__*/_jsx(\"div\",{className:\"error\",children:error}):/*#__PURE__*/_jsx(Webcam,{className:\"webcam\",audio:false,ref:webcamRef,screenshotFormat:\"image/jpeg\",videoConstraints:{facingMode:window.innerWidth<768?{exact:\"environment\"}:\"user\"}}),/*#__PURE__*/_jsx(\"div\",{children:scanResults.map((result,index)=>/*#__PURE__*/_jsx(\"p\",{children:result},index)// display each successful QR code detection\n)})]});}export default StudentHome;","map":{"version":3,"names":["React","useRef","useState","useEffect","Webcam","jsQR","jsx","_jsx","jsxs","_jsxs","StudentHome","webcamRef","scanResults","setScanResults","error","setError","checkPermissions","interval","setInterval","capture","clearInterval","stopWebcam","navigator","mediaDevices","getUserMedia","video","err","console","current","srcObject","tracks","getTracks","forEach","track","stop","imageSrc","getScreenshot","decodeQRFromImage","canvas","document","createElement","ctx","getContext","image","Image","src","onload","width","height","drawImage","imageData","getImageData","code","data","inversionAttempts","prevResults","concat","style","position","children","className","audio","ref","screenshotFormat","videoConstraints","facingMode","window","innerWidth","exact","map","result","index"],"sources":["/Users/justin/Desktop/Work/my_app/src/StudentHome.js"],"sourcesContent":["import React, { useRef, useState, useEffect } from \"react\";\nimport Webcam from \"react-webcam\";\nimport jsQR from \"jsqr\";\n\nfunction StudentHome() {\n  const webcamRef = useRef(null);\n  const [scanResults, setScanResults] = useState([]);\n  const [error, setError] = useState(\"\");\n\n  useEffect(() => {\n    checkPermissions();\n    const interval = setInterval(() => {\n      capture();\n    }, 1000); // continuously capture every 1000 milliseconds (1 second)\n\n    return () => {\n      clearInterval(interval); // clear the interval when the component unmounts\n      stopWebcam();\n    };\n  }, []);\n\n  // check for camera access permissions and handle errors\n  const checkPermissions = async () => {\n    try {\n      await navigator.mediaDevices.getUserMedia({ video: true });\n      // permissions granted\n      setError(\"\");\n    } catch (err) {\n      console.error(\"Error accessing the camera: \", err);\n      setError(\n        \"Camera access was denied. Please allow camera permissions in your browser settings.\"\n      );\n    }\n  };\n\n  const stopWebcam = () => {\n    if (webcamRef.current && webcamRef.current.video.srcObject) {\n      const tracks = webcamRef.current.video.srcObject.getTracks();\n      tracks.forEach((track) => track.stop());\n    }\n  };\n\n  const capture = () => {\n    const imageSrc = webcamRef.current.getScreenshot();\n    if (imageSrc) {\n      decodeQRFromImage(imageSrc);\n    }\n  };\n\n  const decodeQRFromImage = (imageSrc) => {\n    const canvas = document.createElement(\"canvas\");\n    const ctx = canvas.getContext(\"2d\");\n    const image = new Image();\n    image.src = imageSrc;\n    image.onload = () => {\n      canvas.width = image.width;\n      canvas.height = image.height;\n      ctx.drawImage(image, 0, 0, canvas.width, canvas.height);\n      const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);\n      const code = jsQR(imageData.data, imageData.width, imageData.height, {\n        inversionAttempts: \"dontInvert\",\n      });\n      if (code) {\n        setScanResults((prevResults) => [\n          ...prevResults,\n          `QR Code Detected: ${code.data}`,\n        ]);\n      }\n    };\n  };\n\n  return (\n    <div style={{ position: \"relative\" }}>\n      {error ? (\n        <div className=\"error\">{error}</div>\n      ) : (\n        <Webcam\n          className=\"webcam\"\n          audio={false}\n          ref={webcamRef}\n          screenshotFormat=\"image/jpeg\"\n          videoConstraints={{\n            facingMode:\n              window.innerWidth < 768 ? { exact: \"environment\" } : \"user\",\n          }}\n        />\n      )}\n      <div>\n        {scanResults.map((result, index) => (\n          <p key={index}>{result}</p> // display each successful QR code detection\n        ))}\n      </div>\n    </div>\n  );\n}\n\nexport default StudentHome;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}